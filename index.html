<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sistema Grêmio Estudantil - SED</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>

:root{
    --sed-primary:#00a78e;
    --sed-secondary:#0077b6;
    --sed-dark:#1b2c34;
    --sed-bg:#eaf3f4;
}

/* Fundo */
body{
    margin:0;
    padding:30px;
    background:linear-gradient(120deg,#00a896,#0091a1,#0077b6);
    background-size:300% 300%;
    animation:gradientMove 6s infinite alternate;
    font-family:Segoe UI,Arial;
}
@keyframes gradientMove{
    from{background-position:left;}
    to{background-position:right;}
}

/* Container */
.container{
    background:#fff;
    border-radius:14px;
    padding:35px;
    max-width:900px;
    margin:auto;
    box-shadow:0 15px 30px rgba(0,0,0,.15);
    border-top:7px solid var(--sed-primary);
    animation:fade .4s ease;
}
@keyframes fade{
    from{opacity:0;transform:translateY(10px);}
    to{opacity:1;transform:translateY(0);}
}

/* Cabeçalho */
.header-logos{
    display:flex;
    justify-content:space-between;
    align-items:center;
    margin-bottom:25px;
}
.header-logos img{
    max-height:95px;
}

/* Título */
h2{
    text-align:center;
    color:var(--sed-dark);
    margin-top:5px;
    letter-spacing:.5px;
    font-weight:700;
}

/* Inputs */
label{
    font-size:14px;
    color:#333;
    font-weight:600;
}
input,select,textarea{
    width:100%;
    padding:12px;
    border-radius:6px;
    border:1px solid #cfd9df;
    outline:none;
    transition:.2s;
    font-size:15px;
}
input:focus,select:focus,textarea:focus{
    border-color:var(--sed-primary);
    box-shadow:0 0 5px rgba(0,168,150,.6);
}

/* Botões */
button{
    width:100%;
    padding:14px;
    border-radius:6px;
    border:none;
    cursor:pointer;
    color:#fff;
    font-size:16px;
    font-weight:700;
    transition:.2s;
}
.btn-save{background:var(--sed-primary);}
.btn-save:hover{transform:scale(1.01);background:#00816d;}

.btn-log{background:#495057;margin-top:10px;}
.btn-log:hover{transform:scale(1.01);}

.btn-danger{
    background:#d82335;
    width:auto;
    padding:10px 18px;
}

.hidden{display:none;}

/* Tabela */
.table-container{margin-top:15px;overflow:auto;}
table{width:100%;border-collapse:collapse;}
th{
    padding:12px;
    background:#eef3f4;
    color:#333;
}
td{
    padding:12px;
    border-bottom:1px solid #eee;
}

/* Badge */
.badge-download{
    background:var(--sed-primary);
    padding:7px 12px;
    border-radius:6px;
    border:none;
    color:#fff;
    cursor:pointer;
}
.badge-download:hover{opacity:.85}

</style>
</head>
<body>

<!-- LOGIN -->
<div id="login-screen" class="container">
    <div class="header-logos">
        <img src="image_98ed0f.png">
        <img src="image_9943fb.png">
    </div>

    <h2>Portal do Grêmio Estudantil</h2>

    <label>Usuário</label>
    <input id="user">

    <label>Senha</label>
    <input type="password" id="pass">

    <button onclick="handleLogin()">Entrar</button>
</div>

<!-- DASHBOARD -->
<div id="dashboard" class="container hidden">
<div style="text-align:right;font-size:13px;">
<span id="user-display"></span> |
<a href="#" onclick="location.reload()" style="color:#d82335">Sair</a>
</div>

<h2>Cadastro de Ação Estudantil</h2>

<label>Título</label>
<input id="titulo">

<div style="display:flex;gap:10px;">
<div style="flex:1">
<label>Data</label>
<input type="date" id="data">
</div>

<div style="flex:1">
<label>Participantes</label>
<input type="number" id="qtd">
</div>
</div>

<label>Origem da Proposta</label>
<select id="proposta">
<option>Grêmio</option>
<option>Gestão Escolar</option>
<option>GRESP - SEDUC</option>
</select>

<label>Tema</label>
<input id="tema">

<label>Descrição Completa</label>
<textarea rows="4" id="descricao"></textarea>

<button class="btn-save" onclick="salvarAcao()">Salvar Registro</button>
<button class="btn-log" onclick="acessarLogs()">Ver Logs</button>
</div>

<!-- LOGS -->
<div id="logs-screen" class="container hidden">
<h2>Histórico de Registros</h2>

<div style="display:flex;justify-content:space-between;">
<button style="background:#343a40;width:auto;padding:10px 20px" onclick="voltarDash()">Voltar</button>
<button class="btn-danger" onclick="limparBanco()">Limpar Histórico</button>
</div>

<div class="table-container">
<table>
<thead>
<tr>
<th>Data</th>
<th>Autor</th>
<th>Ação</th>
<th>PDF</th>
</tr>
</thead>
<tbody id="log-table-body"></tbody>
</table>
</div>
</div>

<script>
const { jsPDF } = window.jspdf;
const users={admin:"1234",gremio:"gremio123"};
let loggedUser="";
const DB='gremio_db_v6';

function handleLogin(){
 let u=user.value,p=pass.value;
 if(users[u]===p){
 loggedUser=u;
 login-screen.classList.add("hidden");
 dashboard.classList.remove("hidden");
 user-display.innerText="Usuário: "+u;
 }else alert("Login inválido");
}

function salvarAcao(){
 let r={
 id:Date.now(),
 autor:loggedUser,
 dataReg:new Date().toLocaleDateString(),
 horaReg:new Date().toLocaleTimeString(),
 titulo:titulo.value,
 dataAcao:data.value,
 qtd:qtd.value,
 proposta:proposta.value,
 tema:tema.value,
 descricao:descricao.value
 };
 if(!r.titulo||!r.dataAcao) return alert("Preencha título e data!");
 let logs=JSON.parse(localStorage.getItem(DB)||"[]");
 logs.push(r);
 localStorage.setItem(DB,JSON.stringify(logs));
 alert("Salvo com sucesso!");
 document.querySelectorAll('input,textarea').forEach(x=>x.value="");
}

function acessarLogs(){
 if(prompt("Senha restrita:")=="0000"){
 dashboard.classList.add("hidden");
 logs-screen.classList.remove("hidden");
 renderLogs();
 }else alert("Negado");
}

function renderLogs(){
 let t=log-table-body;
 let logs=JSON.parse(localStorage.getItem(DB)||"[]").filter(l=>l&&l.titulo);
 t.innerHTML="";
 if(!logs.length){
 t.innerHTML="<tr><td colspan=4 style='text-align:center'>Nenhum registro</td></tr>";
 return;
 }
 logs.reverse().forEach(l=>{
 t.innerHTML+=`
<tr>
<td>${l.dataReg} ${l.horaReg}</td>
<td><b>${l.autor}</b></td>
<td>${l.titulo}</td>
<td><button class="badge-download" onclick="gerarPDF(${l.id})">Baixar</button></td>
</tr>`;
 });
}

function gerarPDF(id){
 let d=JSON.parse(localStorage.getItem(DB)).find(x=>x.id===id);
 if(!d)return;
 let doc=new jsPDF();

 doc.setFillColor(0,168,150);
 doc.rect(0,0,210,40,"F");

 doc.setTextColor(255,255,255);
 doc.setFontSize(20);
 doc.text("RELATÓRIO DE AÇÃO ESTUDANTIL",105,25,{align:"center"});

 doc.setTextColor(0,0,0);
 doc.setFontSize(12);

 doc.text("Escola: E.E. Profº João Teixeira Sampaio",20,55);
 doc.text("Grêmio: Geração Consciente",20,63);

 doc.text("Título: "+d.titulo,20,78);
 doc.text("Data da Ação: "+d.dataAcao,20,88);
 doc.text("Participantes: "+d.qtd,20,98);
 doc.text("Proposta: "+d.proposta,20,108);
 doc.text("Tema: "+d.tema,20,118);

 doc.line(20,125,190,125);
 doc.setFont("helvetica","bold");
 doc.text("Descrição:",20,135);
 doc.setFont("helvetica","normal");

 let lines=doc.splitTextToSize(d.descricao,170);
 doc.text(lines,20,145);

 doc.setFontSize(10);
 doc.text("Emitido em: "+d.dataReg+" às "+d.horaReg+" por "+d.autor,20,285);

 doc.save("Relatorio_"+d.titulo+".pdf");
}

function limparBanco(){
 if(confirm("Apagar tudo?")){
 localStorage.removeItem(DB);
 renderLogs();
}
}
function voltarDash(){
 logs-screen.classList.add("hidden");
 dashboard.classList.remove("hidden");
}
</script>

</body>
</html>
